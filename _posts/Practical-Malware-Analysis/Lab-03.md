---
title: "Lab 3 - Practical Malware Analysis"
classes: wide
header:
  #teaser: /assets/images/Vidar-Stealer-Camapign/logo.png
  #overlay_image: /assets/images/Vidar-Stealer-Camapign/logo.png
  overlay_filter: 0.5
ribbon: DarkSlateGray
categories: [practical-malware-analysis]
tags:
  - Vidar
  - .NET
  - PowerShell
  - C/C++
  - IDA
  - IDAPython
  - Yara
toc: true
toc_sticky: true
---


**Lab03-02**

Question 2

1\) C:\\>rundl 32.exe lab03-02.dl , Instal 2\) Given this has been instal ed as a service and we know the name is IPRIP we can run it through either the net utility, or SC Tool. 

3\) By searching for the specified DLL, or looking at the DLLs loaded by a process in Process Explorer, we’re able to get the process ID of the svchost process which is running this malware. 

4\) We can use procmon and filter by the Process ID to glean information only on the svchost process responsible for running this malware. 





5\)

IOCs:

● PRIP

● Intranet Network Awareness \(INA\+\)

● Depends INA\+, Col ects and stores network configuration and location information, and notifies applications when this information changes. 

● HKLM\\SYSTEM\\CurrentControlSet\\Services\\IPRIP\\Parameters\\ /v servicedl



**Lab03-03**

1\) While monitoring the exe file with Process Explorer lab03-03.exe spawns svchost.exe:

2\) By looking into the live memory of svchost we can see the strings differ significantly on disk to what is in memory. 





3\) IOCs:

practicalmalwareanalysis.log



4\) By opening wordpad and typing out some content, we can then open up practicalmalwareanalysis.log and see that it has logged al of our keystrokes. 

From this we can conclude that this uses process hol owing to run a keylogger:



**Lab03-04**

1\) When we run this file it immediately deletes itself. We can see this event coming from the program spawning a del \(delete\) command from a command prompt. 

2\) This could be caused by command line parameters needing to be passed to the program, it needing to fetch a particular file from a remote location, it detecting it is in a sandbox, it only targeting a particular timezone, or it only running on a specific domain. Some clues can be found by looking at the program strings. 

3\) Attempting to run with the below enumerated through strings stil results in the file being deleted, so at this stage we cannot do much more; however, this wil be revisited in lab 9.



